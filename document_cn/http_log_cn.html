<!DOCTYPE html><html lang="cn" dir="ltr" class="no-js" data-env="dev-env"><head><meta charset="utf-8"><meta name="renderer" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="Designed by 阿里云UED AX"><title>ngx_http_log_module - The Tengine Web Server</title><meta name="description" content="&amp;#x6269;&amp;#x5C55;&amp;#x65E5;&amp;#x5FD7;&amp;#x6A21;&amp;#x5757;&amp;#xFF0C;&amp;#x63D0;&amp;#x4F9B;syslog&amp;#x548C;pipe&amp;#xFF0C;&amp;#x4EE5;&amp;#x53CA;&amp;#x65E5;&amp;#x5FD7;&amp;#x91C7;&amp;#x6837;&amp;#x3002;&amp;#x5F00;&amp;#x542F;syslog&amp;#x65E5;&amp;#x5FD7;&amp;#x529F;"><meta property="og:type" content="article"><meta property="og:title" content="ngx_http_log_module"><meta property="og:url" content="http://tengine.taobao.org/document_cn/http_log_cn.html"><meta property="og:site_name" content="The Tengine Web Server"><meta property="og:description" content="&amp;#x6269;&amp;#x5C55;&amp;#x65E5;&amp;#x5FD7;&amp;#x6A21;&amp;#x5757;&amp;#xFF0C;&amp;#x63D0;&amp;#x4F9B;syslog&amp;#x548C;pipe&amp;#xFF0C;&amp;#x4EE5;&amp;#x53CA;&amp;#x65E5;&amp;#x5FD7;&amp;#x91C7;&amp;#x6837;&amp;#x3002;&amp;#x5F00;&amp;#x542F;syslog&amp;#x65E5;&amp;#x5FD7;&amp;#x529F;"><meta property="og:updated_time" content="2016-12-02T04:52:08.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="ngx_http_log_module"><meta name="twitter:description" content="&amp;#x6269;&amp;#x5C55;&amp;#x65E5;&amp;#x5FD7;&amp;#x6A21;&amp;#x5757;&amp;#xFF0C;&amp;#x63D0;&amp;#x4F9B;syslog&amp;#x548C;pipe&amp;#xFF0C;&amp;#x4EE5;&amp;#x53CA;&amp;#x65E5;&amp;#x5FD7;&amp;#x91C7;&amp;#x6837;&amp;#x3002;&amp;#x5F00;&amp;#x542F;syslog&amp;#x65E5;&amp;#x5FD7;&amp;#x529F;"><link rel="alternate" href="/atom.xml" title="The Tengine Web Server" type="application/atom+xml"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/main.css"></head><body class="page-is-loading"><div class="fluid-container global-header"><div class="container"><div class="header clearfix"><nav id="nav-menu"><ul class="nav nav-pills pull-right"><li role="presentation"><a class="menu-item" href="/download.html">下载</a></li><li role="presentation"><a class="menu-item" href="/source.html">源码</a></li><li role="presentation"><a class="menu-item" href="/documentation.html">文档</a></li><li role="presentation"><a class="menu-item" href="/faq.html">FAQ</a></li><li role="presentation"><a class="menu-item" href="/contact.html">联系我们</a></li><li role="presentation"><a class="menu-item" href="http://tengine.taobao.org/book/">教程</a></li><li role="presentation" class="hide"><a href="#"><i class="fa fa-bars" aria-hidden="true"></i></a></li></ul></nav><h1 class="text-muted site-logo"><a href="/" id="logo">The Tengine Web Server</a></h1></div></div></div><div class="outer"><section id="main"><div class="fluid-container"><div class="container"><article id="post-document_cn/http_log_cn" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">ngx_http_log_module</h1></header><div class="article-entry" itemprop="articleBody"><p>&#x6269;&#x5C55;&#x65E5;&#x5FD7;&#x6A21;&#x5757;&#xFF0C;&#x63D0;&#x4F9B;syslog&#x548C;pipe&#xFF0C;&#x4EE5;&#x53CA;&#x65E5;&#x5FD7;&#x91C7;&#x6837;&#x3002;</p><p>&#x5F00;&#x542F;syslog&#x65E5;&#x5FD7;&#x529F;&#x80FD;&#x9700;&#x8981;&#x5728;&#x7F16;&#x8BD1;&#x662F;&#x6DFB;&#x52A0;&#x53C2;&#x6570;<strong>&#x2013;with-syslog</strong>&#xFF0C;&#x5426;&#x5219;syslog&#x4E0D;&#x4F1A;&#x751F;&#x6548;&#x3002;</p><p>syslog&#x6A21;&#x5757;&#x517C;&#x5BB9;syslogd&#x3002;&#x4F7F;&#x7528;syslog-ng&#x9700;&#x8981;&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4EE5;&#x652F;&#x6301;udp&#x548C;unix-dgram&#xFF0C;&#x5E76;&#x5C4F;&#x853D;unix-stream&#xFF1A;</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">source s_sys {</div><div class="line">    file (&quot;/proc/kmsg&quot; program_override(&quot;kernel: &quot;));</div><div class="line">    unix-dgram (&quot;/dev/log&quot;);</div><div class="line">    internal();</div><div class="line">    udp(ip(0.0.0.0) port(514));</div><div class="line">};</div></pre></td></tr></table></figure><h2 id="&#x6307;&#x4EE4;"><a href="#&#x6307;&#x4EE4;" class="headerlink" title="&#x6307;&#x4EE4;"></a>&#x6307;&#x4EE4;</h2><blockquote><p>Syntax: <strong>access_log</strong> log_target [format [ratio=ratio] [buffer=size]] | off<br>Default: access_log logs/access.log combined ratio=1<br>Context: http, server, location</p></blockquote><p>format&#xFF08;&#x542B;&#xFF09;&#x524D;&#x9762;&#x7684;&#x5404;&#x53C2;&#x6570;&#x987A;&#x5E8F;&#x56FA;&#x5B9A;&#xFF0C;&#x540E;&#x9762;&#x7684;&#x53C2;&#x6570;&#x53EF;&#x4E71;&#x5E8F;&#x3002;&#x6B64;&#x683C;&#x5F0F;&#x517C;&#x5BB9;nginx&#x539F;&#x6709;access_log&#x683C;&#x5F0F;&#x3002;</p><p><code>log_target</code></p><p>&#x517C;&#x5BB9;&#x4EE5;&#x524D;&#x7684;log_file&#x53C2;&#x6570;&#xFF0C;&#x5E76;&#x6DFB;&#x52A0;&#x4E0B;&#x9762;&#x4E09;&#x79CD;&#x65E5;&#x5FD7;&#x7C7B;&#x578B;&#xFF1A;</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">file:/path/to/file</div><div class="line">syslog:facility[:[loglevel][:[target_ip:[target_port] | target_udgram_addr][:ident]]]</div><div class="line">&quot;pipe:/path/to/exec parms&quot;</div></pre></td></tr></table></figure><p><code>ratio</code></p><p>&#x5728;buffer&#x53C2;&#x6570;&#x524D;&#xFF0C;&#x6307;&#x5B9A;tengine&#x4EE5;&#x56FA;&#x5B9A;&#x7684;&#x91C7;&#x6837;&#x7387;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x3002;&#x4F8B;&#x5982;&#xFF1A;ratio=0.0001&#xFF0C;&#x90A3;&#x4E48;&#x6BCF;&#x7ECF;&#x8FC7;10000&#x6761;&#x8BB0;&#x5F55;&#xFF0C;tengine&#x4F1A;&#x8BB0;&#x5F55;&#x4E00;&#x6761;&#x3002;</p><p>&#x5982;&#x679C;&#x9700;&#x8981;&#x4F7F;&#x7528;buffer&#x53C2;&#x6570;&#x800C;&#x4E0D;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x65E5;&#x5FD7;&#x91C7;&#x6837;&#xFF0C;&#x4E0D;&#x80FD;&#x7701;&#x7565;&#x6B64;&#x53C2;&#x6570;&#xFF0C;&#x9700;&#x8981;&#x8BBE;&#x7F6E;ratio=1&#x3002;</p><p>&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x4E0B;&#x652F;&#x6301;&#x7684;&#x4E09;&#x79CD;log_target&#xFF1A;</p><ul><li><p><code>file</code> &#x4E0E;nginx&#x7684;log_file&#x5BF9;&#x5E94;&#x7684;&#x7C7B;&#x578B;&#xFF1B;</p></li><li><p><code>syslog</code> &#x652F;&#x6301;&#x901A;&#x8FC7;syslog&#x65B9;&#x5F0F;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#xFF1B;</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">facility := auth | authpriv | cron | daemon | ftp | kern | lpr | mail | mark | news | security | syslog</div><div class="line">| user | uucp | local0 | local1 | local2 | local3 | local4 | local5 | local6 | local7</div><div class="line"></div><div class="line">loglevel := crit | err | error | emerg | panic | alert | warn | warning | info | notice | debug</div><div class="line">loglevel&#x9ED8;&#x8BA4;&#x503C; = info</div><div class="line"></div><div class="line">target_ip:[target_port]&#xFF1A;&#x65E5;&#x5FD7;&#x8F93;&#x51FA;&#x76EE;&#x7684;&#x4E3B;&#x673A;&#x7684;IP&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#xFF0C;&#x7AEF;&#x53E3;&#x9ED8;&#x8BA4;&#x662F;UDP(514)&#x3002;&#x8FD9;&#x91CC;syslog&#x53EA;&#x652F;&#x6301;UDP&#x534F;&#x8BAE;</div><div class="line"></div><div class="line">target_udgram_addr&#xFF1A;unix dgram&#x5730;&#x5740;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;Unix dgram(/dev/log)&#x3002;&#x8FD9;&#x91CC;syslog&#x53EA;&#x652F;&#x6301;UNIX DGRAM&#x534F;&#x8BAE;</div><div class="line"></div><div class="line">ident: &#x81EA;&#x5B9A;&#x4E49;&#x6807;&#x5FD7;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x5E94;&#x7528;&#x4FE1;&#x606F;</div></pre></td></tr></table></figure><p>&#x4F8B;&#x5982;&#xFF1A;</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">syslog:user:info:127.0.0.1:514:ident          &#x4EE5;user&#x7C7B;&#x578B;&#x548C;info&#x7EA7;&#x522B;&#x5C06;&#x65E5;&#x5FD7;&#x53D1;&#x9001;&#x7ED9;127.0.0.1:514&#x7684;UDP&#x7AEF;&#x53E3;&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x5E94;&#x7528;&#x6807;&#x8BB0;&#x4E3A;ident</div><div class="line">syslog&#x7684;&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;&quot;May  4 15:44:15 local ident[26490]: XXXXXXXX&quot;</div><div class="line">syslog:auth:err:10.232.4.28::ident            &#x4EE5;auth&#x7C7B;&#x578B;&#x548C;err&#x7EA7;&#x522B;&#x5C06;&#x65E5;&#x5FD7;&#x53D1;&#x9001;&#x5230;&#x4E3B;&#x673A;10.232.4.28:514&#x7684;UDP&#x7AEF;&#x53E3;&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x5E94;&#x7528;&#x6807;&#x8BB0;&#x4E3A;ident</div><div class="line">syslog:user:info:/dev/log:ident               &#x4EE5;user&#x7C7B;&#x578B;&#x548C;info&#x7EA7;&#x522B;&#x5C06;&#x65E5;&#x5FD7;&#x53D1;&#x9001;&#x7ED9;&#x672C;&#x673A;Unix dgram(/dev/log)&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x5E94;&#x7528;&#x6807;&#x8BB0;&#x4E3A;ident</div><div class="line">syslog:user::/dev/log:ident                   &#x4EE5;user&#x7C7B;&#x578B;&#x548C;info&#x7EA7;&#x522B;&#x5C06;&#x65E5;&#x5FD7;&#x53D1;&#x9001;&#x7ED9;&#x672C;&#x673A;Unix dgram(/dev/log)&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x5E94;&#x7528;&#x6807;&#x8BB0;&#x4E3A;ident</div><div class="line">syslog:user:info::ident                       &#x4EE5;user&#x7C7B;&#x578B;&#x548C;info&#x7EA7;&#x522B;&#x5C06;&#x65E5;&#x5FD7;&#x53D1;&#x9001;&#x7ED9;&#x672C;&#x673A;Unix dgram(/dev/log)&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x5E94;&#x7528;&#x6807;&#x8BB0;&#x4E3A;ident</div><div class="line">syslog:cron:debug:/dev/log                    &#x4EE5;cron&#x7C7B;&#x578B;&#x548C;debug&#x7EA7;&#x522B;&#x5C06;&#x65E5;&#x5FD7;&#x53D1;&#x9001;&#x5230;&#x4E3B;&#x673A;Unix dgram(/dev/log)&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x6807;&#x8BB0;</div><div class="line">syslog&#x7684;&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;&quot;May  4 15:44:15 local NGINX[26490]: XXXXXXXX&quot;</div><div class="line">syslog:user::127.0.0.1                        &#x4EE5;user&#x7C7B;&#x578B;&#x548C;info&#x7EA7;&#x522B;&#x5C06;&#x65E5;&#x5FD7;&#x53D1;&#x9001;&#x7ED9;127.0.0.1:514&#x7684;UDP&#x7AEF;&#x53E3;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x6807;&#x8BB0;</div><div class="line">syslog:user:debug                             &#x4EE5;user&#x7C7B;&#x578B;&#x548C;debug&#x7EA7;&#x522B;&#x5C06;&#x65E5;&#x5FD7;&#x53D1;&#x9001;&#x7ED9;&#x672C;&#x673A;Unix dgram(/dev/log)&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x6807;&#x8BB0;</div><div class="line">syslog:user                                   &#x4EE5;user&#x7C7B;&#x578B;&#x548C;info&#x7EA7;&#x522B;&#x5C06;&#x65E5;&#x5FD7;&#x53D1;&#x9001;&#x7ED9;&#x672C;&#x673A;Unix dgram(/dev/log)&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x6807;&#x8BB0;</div></pre></td></tr></table></figure><ul><li>pipe</li></ul><p>&#x56E0;&#x4E3A;pipe&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x542B;&#x6709;&#x7A7A;&#x683C;&#x7684;&#x7F18;&#x6545;&#xFF0C;pipe&#x9700;&#x8981;&#x4F7F;&#x7528;&#x53CC;&#x5F15;&#x53F7;&#x5F15;&#x7528;&#xFF0C;&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x7684;&#x53CC;&#x5F15;&#x53F7;&#x9700;&#x8981;&#x8F6C;&#x4E49;&#x3002;</p><p>&#x53E6;&#x5916;pipe&#x8FDB;&#x7A0B;&#x7684;(user, group)&#x9075;&#x5FAA;tengine&#x6307;&#x4EE4;user&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x4F7F;&#x7528;user&#x6307;&#x4EE4;&#x914D;&#x7F6E;&#x7684;&#x8BDD;&#xFF0C;pipe&#x8FDB;&#x7A0B;&#x5C06;&#x9075;&#x5FAA;tengine&#x7684;&#x9ED8;&#x8BA4;&#x7528;&#x6237;&#x8BBE;&#x7F6E;&#xFF0C;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x6CA1;&#x6709;&#x5236;&#x5B9A;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;&#x662F;(nobody, nobody)&#x3002;&#x8BF7;&#x6CE8;&#x610F;&#x7ED9;&#x4E0E;pipe&#x8FDB;&#x7A0B;&#x9002;&#x5F53;&#x7684;&#x6743;&#x9650;&#x3002;</p><hr><blockquote><p>Syntax: <strong>error_log</strong> log_target [debug | info | notice | warn | error | crit]<br>Default: error_log logs/error.log<br>Context: core, http, server, location</p></blockquote><p>&#x4E3A;error_log&#x589E;&#x52A0;syslog&#x548C;pipe&#x652F;&#x6301;&#xFF0C;&#x4F7F;&#x7528;&#x540C;access_log&#x3002;</p><hr><blockquote><p>Syntax: <strong>syslog_retry_interval</strong> seconds<br>Default: syslog_retry_interval 1800<br>Context: core</p></blockquote><p>&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x5931;&#x8D25;&#x540E;&#xFF0C;&#x4E0B;&#x4E00;&#x6B21;&#x91CD;&#x8BD5;&#x7684;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#xFF0C;&#x5355;&#x4F4D;&#xFF1A;&#x79D2;&#x3002;</p><hr><blockquote><p>Syntax: <strong>log_escape</strong> on | off | ascii<br>Default: log_escape on<br>Context: core, http, server, location</p></blockquote><ul><li>&#x2018;on&#x2019;: access&#x65E5;&#x5FD7;&#x91CC;&#x9762;&#x5BF9;&#x7279;&#x6B8A;&#x5B57;&#x7B26;(&#x9664;&#x4E86;<a href="http://en.wikipedia.org/wiki/Percent-encoding#Types_of_URI_characters" target="_blank" rel="external">&#x4FDD;&#x7559;&#x6216;&#x8005;&#x975E;&#x4FDD;&#x7559;&#x5B57;&#x7B26;</a>) &#x7F16;&#x7801;&#x3002;</li><li>&#x2018;off&#x2019;: &#x5BF9;&#x6240;&#x6709;&#x7684;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x90FD;&#x4E0D;&#x7F16;&#x7801;&#x3002;</li><li>&#x2018;acsii&#x2019;: &#x53EA;&#x5BF9;&#x4E0D;&#x53EF;&#x89C1;&#x5B57;&#x7B26;&#x5B57;&#x7B26;&#x8FDB;&#x884C;&#x7F16;&#x7801;&#x3002;</li></ul></div></div></article></div></div></section></div><div class="fluid-container global-footer"><div class="container"><div class="row"><div class="col-lg-6"><div class="footer-logo"></div></div><div class="col-lg-6 clearfix"><select class="lang-switch pull-right"></select></div></div><div class="row"><div class="col-lg-12"><span class="footer-text copyright">&copy; 2011-2016 Alibaba Inc. All rights reserved.</span> <span class="footer-text design-by">Designed by 阿里云UED AX</span></div></div></div></div><script src="/js/jquery.min.js"></script><script src="/js/particles.min.js"></script><script src="/js/app.min.js"></script></body></html>