<!DOCTYPE html>
<html lang="cn" dir="ltr" class="no-js" data-env="dev-env">

<head>

  <meta charset="utf-8"/>

  <meta name="renderer" content="webkit"/>

  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  

  

  <meta name="author" content="Designed by 阿里云UED AX"/>

  
  <meta name="robots" content="index, follow"/>

  <link rel="dns-prefetch" href="//" />
  <link rel="dns-prefetch" href="//" />

  <link rel="shortcut icon" href="///favicon.ico?v=s&t=20150120-2R" />

  

  <title>The Tengine Web Server</title>

  
    <meta property="og:type" content="website">
<meta property="og:title" content="The Tengine Web Server">
<meta property="og:url" content="http://tengine.taobao.org/page/2/index.html">
<meta property="og:site_name" content="The Tengine Web Server">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="The Tengine Web Server">

    
      <link rel="alternate" href="/atom.xml" title="The Tengine Web Server" type="application/atom+xml">
    
  


  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/bootstrap.css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">

</head>


<body class="page-is-loading">

  <div class="fluid-container global-header">
    <div class="container">
        <div class="header clearfix">
            <nav>
                <ul class="nav nav-pills pull-right">
                    
                    <li role="presentation"><a href="/download.html">下载</a></li>
                    
                    <li role="presentation"><a href="/source.html">源码</a></li>
                    
                    <li role="presentation"><a href="/documentation.html">文档</a></li>
                    
                    <li role="presentation"><a href="/faq.html">FAQ</a></li>
                    
                    <li role="presentation"><a href="/contact.html">联系我们</a></li>
                    
                    <li role="presentation"><a href="http://tengine.taobao.org/book/">教程</a></li>
                    
                    <li role="presentation" class="hide"><a href="#"><i class="fa fa-bars" aria-hidden="true"></i></a></li>
                </ul>
            </nav>
            <h1 class="text-muted site-logo"><a href="/" id="logo">The Tengine Web Server</a></h1>
        </div>
    </div>
</div>

  <div class="outer">
    <section id="main">

    <!-- 文章分页 -->
    
    
        <div class="fluid-container">
    <div class="container">

        <article id="post-document/http_footer_filter" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                <header class="article-header">
                    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/document/http_footer_filter/">ngx_http_footer_filter_module</a>
    </h1>
  

                </header>
                
                <div class="article-entry" itemprop="articleBody">
                    
                    <p>This module appends a string to the end of the response body. The string can contain variables.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">location / &#123;</div><div class="line">    root html;</div><div class="line">    footer_types &quot;text/plain&quot; &quot;text/css&quot; &quot;application/x-javascript&quot;;</div><div class="line">    footer &quot;$host_comment&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Directives"><a href="#Directives" class="headerlink" title="Directives"></a>Directives</h2><p>Syntax: <strong>footer</strong> format</p>
<p>Default: none</p>
<p>Context: http, server, location</p>
<p>Set a string to append to the end of the response body. </p><p><br>    The parameter can contain variables. For example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">location / &#123;</div><div class="line">    footer &quot;&amp;lt;!-- $hostname, $year/$month/$day $hour:$minute:$second, $request --&amp;gt;&quot;;</div><div class="line">    index index.html;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Syntax: <strong>footer_types</strong> type1 [type2] [type3]</p>
<p>Default: footer_types text/html</p>
<p>Context: http, server, location</p>
<p>Specify the MIME types the footer will append on.</p>

                    
                </div>

            </div>
        </article>

    </div>
</div>


    
        <div class="fluid-container">
    <div class="container">

        <article id="post-document/http_headers" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                <header class="article-header">
                    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/document/http_headers/">ngx_http_headers_module</a>
    </h1>
  

                </header>
                
                <div class="article-entry" itemprop="articleBody">
                    
                    <p>This is the enhanced version of nginx’s http_headers module. A new ‘expires_by_types’ directive is brought in to allow setting the expiration times according to different MIME types.</p>
<h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">expires_by_types       24h text/html;</div><div class="line">expires_by_types       modified +24h text/xml;</div><div class="line">expires_by_types       @15h30m text/xml;</div><div class="line">expires_by_types       0 text/xml;</div><div class="line">expires_by_types       -1 text/xml;</div><div class="line">expires_by_types       epoch text/xml;</div></pre></td></tr></table></figure>
<h2 id="Directives"><a href="#Directives" class="headerlink" title="Directives"></a>Directives</h2><p>Syntax: expires_by_types [[modified] time | @time-of-day | epoch | max | off] content-type1 [content-type2] …</p>
<p>Default: none</p>
<p>Context: http, server, location</p>
<p>Specify an expiration time according to some MIME types.</p><p><br>The format of an expiration time is the same as nginx’s ‘expires’. You can add one or more MIME types after the time parameter. </p>
<p>Note if there are both ‘expires’ and ‘expires_by_types’ directives being set:</p>
<ul>
<li>If they are in the same block level, the exactly matched MIME type and its expiration time of ‘expires_by_type’ will be preferred. Otherwise, the expiration time of ‘expires’ will be honored.*   If ‘expires’ and ‘expires_by_types’ are not set, the expiration setting will be inherited from the parent level.</li>
<li>If ‘expires off’ is specified in the current level, all of the ‘expires’ and ‘expires_by_types’ settings will be turned off.</li>
<li>If ‘expires off’ is specified in the parent level but not the current block, the setting of ‘expires_by_types’ in the current level will be honored.</li>
</ul>
<p>For example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">location /url &#123;</div><div class="line">    expires                10s;</div><div class="line">    expires_by_types       24s text/html;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The expiration time of the ‘text/html’ MIME type is 24 seconds for the ‘/url’ location. It’s 10 seconds for the rest.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">expires                    10s;</div><div class="line">expires_by_types           24s text/html;</div><div class="line"></div><div class="line">location /url &#123;</div><div class="line">    expires_by_types       20s text/rss;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The expiration time of the ‘text/rss’ MIME type is 20 seconds for the ‘/url’ location; The expiration time is 24 seconds for the ‘text/html’ MIME type and 10 seconds for the rest. Because the the setting in the parent level is overriden by the ‘expires_by_types’ in the ‘/url’ location, while other ‘expires’ settings are inherited from the parent level.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">expires                    10s;</div><div class="line">expires_by_types           24s text/html;</div><div class="line"></div><div class="line">location /url &#123;</div><div class="line">    expires off;</div><div class="line">    expires_by_types       20s text/rss;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The expiration time is not specified in the ‘/url’ location. See Rule 3 above.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">expires off;</div><div class="line">expires_by_types           24s text/html;</div><div class="line"></div><div class="line">location /url &#123;</div><div class="line">    expires_by_types       20s text/rss;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The expiration time for the ‘text/html’ MIME type is 20 seconds in the ‘/url’ location. See Rule 4 above.</p>

                    
                </div>

            </div>
        </article>

    </div>
</div>


    
        <div class="fluid-container">
    <div class="container">

        <article id="post-document/http_concat" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                <header class="article-header">
                    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/document/http_concat/">ngx_http_concat_module</a>
    </h1>
  

                </header>
                
                <div class="article-entry" itemprop="articleBody">
                    
                    <p>The module is inspired by Apache’s<br><a href="http://code.google.com/p/modconcat" target="_blank" rel="external"><code>modconcat</code></a>. It follows the same<br>pattern for enabling the concatenation. It uses two <code>?</code>, like this: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://example.com/??style1.css,style2.css,foo/style3.css</div></pre></td></tr></table></figure>
<p>If a <strong>third</strong> <code>?</code> is present it’s treated as <strong>version string</strong>. Like<br>this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://example.com/??style1.css,style2.css,foo/style3.css?v=102234</div></pre></td></tr></table></figure>
<h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">location /static/css/ &#123;</div><div class="line">    concat on;</div><div class="line">    concat_max_files 20;</div><div class="line">&#125;</div><div class="line"></div><div class="line">location /static/js/ &#123;</div><div class="line">    concat on;</div><div class="line">    concat_max_files 30;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Directives"><a href="#Directives" class="headerlink" title="Directives"></a>Directives</h2><p><strong>concat</strong> <code>on</code> | <code>off</code></p>
<p><strong>default:</strong> <code>concat off</code></p>
<p><strong>context:</strong> <code>http, server, location</code></p>
<p>It enables the concatenation in a given context.</p>
<p><strong>concat_types</strong> <code>MIME types</code></p>
<p><strong>default:</strong> <code>concat_types: text/css application/x-javascript</code></p>
<p><strong>context:</strong> <code>http, server, location</code></p>
<p>Defines the <a href="http://en.wikipedia.org/wiki/MIME_type" target="_blank" rel="external">MIME types</a> which<br>can be concatenated in a given context.</p>
<p><strong>concat_unique</strong> <code>on</code> | <code>off</code></p>
<p><strong>default:</strong> <code>concat_unique on</code></p>
<p><strong>context:</strong> <code>http, server, location</code></p>
<p>Defines if only files of a given MIME type can concatenated or if<br>several MIME types can be concatenated. For example if set to <code>off</code><br>then in a given context you can concatenate Javascript and CSS files.</p>
<p>Note that the default value is <code>on</code>, meaning that only files with same<br>MIME type are concatenated in a given context. So if you have CSS and<br>JS you cannot do something like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://example.com/static/??foo.css,bar/foobaz.js</div></pre></td></tr></table></figure>
<p>In order to do that you <strong>must</strong> set <code>concat_unique off</code>. This applies<br>to any other type of files that you decide to concatenate by adding<br>the respective MIME type via <code>concat_types</code>,</p>
<p><strong>concat_max_files</strong> <code>number</code>p</p>
<p><strong>default:</strong> <code>concat_max_files 10</code></p>
<p><strong>context:</strong> <code>http, server, location</code></p>
<p>Defines the <strong>maximum</strong> number of files that can be concatenated in a<br>given context. Note that a given URI cannot be bigger than the page<br>size of your platform. On Linux you can get the page size issuing:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getconf PAGESIZE</div></pre></td></tr></table></figure>
<p>Usually is 4k. So if you try to concatenate a lot of files together in<br>a given context you might hit this barrier. To overcome that OS<br>defined limitation you must use<br>the <a href="http://wiki.nginx.org/NginxHttpCoreModule#large_client_header_buffers" target="_blank" rel="external"><code>large_client_header_buffers</code></a><br>directive. Set it to the value you need.</p>

                    
                </div>

            </div>
        </article>

    </div>
</div>


    
        <div class="fluid-container">
    <div class="container">

        <article id="post-document/http_limit_req" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                <header class="article-header">
                    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/document/http_limit_req/">ngx_http_limit_req_module</a>
    </h1>
  

                </header>
                
                <div class="article-entry" itemprop="articleBody">
                    
                    <p>This is the enhanced version of nginx’s limit_req module with white list support, and more limit conditions are allowed in a single location.</p>
<h2 id="Directives"><a href="#Directives" class="headerlink" title="Directives"></a>Directives</h2><p>Syntax: <strong>limit_req_zone</strong> $session_variable1 $session_variable2 … zone=name_of_zone:size rate=rate</p>
<p>Default: none</p>
<p>Context: http</p>
<p>Support more than one limit variables. For example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">limit_req_zone $binary_remote_addr $uri zone=one:3m rate=1r/s;</div><div class="line">limit_req_zone $binary_remote_addr $request_uri zone=two:3m rate=1r/s;</div></pre></td></tr></table></figure>
<p>The last line of the above example indicates a client can access a specific URI only once in a second.</p>
<p>Syntax: <strong>limit_req</strong> [on | off] | zone=zone_name burst=burst [forbid_action=action] [nodelay]</p>
<p>Default: none</p>
<p>Context: http, server, location</p>
<p>Multiple limit conditions are allowed in a single block. And all the conditions are examined in order.</p>
<p>You can turn this directive on or off (default is on).</p><p><br>‘forbid_action’ specifies the action URL to redirect. It can be a named location. By default, tengine will return 503.</p>
<p>For example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">limit_req_zone $binary_remote_addr zone=one:3m rate=1r/s;</div><div class="line">limit_req_zone $binary_remote_addr $uri zone=two:3m rate=1r/s;</div><div class="line">limit_req_zone $binary_remote_addr $request_uri zone=three:3m rate=1r/s;</div><div class="line"></div><div class="line">location / &#123;</div><div class="line">    limit_req zone=one burst=5;</div><div class="line">    limit_req zone=two forbid_action=@test1;</div><div class="line">    limit_req zone=three burst=3 forbid_action=@test2;</div><div class="line">&#125;</div><div class="line"></div><div class="line">location /off &#123;</div><div class="line">    limit_req off;</div><div class="line">&#125;</div><div class="line"></div><div class="line">location @test1 &#123;</div><div class="line">    rewrite ^ /test1.html;</div><div class="line">&#125;</div><div class="line"></div><div class="line">location @test2 &#123;</div><div class="line">    rewrite ^  /test2.html;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Syntax: <strong>limit_req_whitelist</strong> geo_var_name=var_name geo_var_value=var_value</p>
<p>Default: none</p>
<p>Context: http, server, location</p>
<p>Set the whitelist.</p>
<p>This directive needs work with the geo module. The ‘geo_var_name’ is the variable name declared in the geo module, ‘geo_var_value’ is its value. For example: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">geo $white_ip &#123;</div><div class="line">    ranges;</div><div class="line">    default 0;</div><div class="line">    127.0.0.1-127.0.0.255 1;</div><div class="line">&#125;</div><div class="line"></div><div class="line">limit_req_whitelist geo_var_name=white_ip geo_var_value=1;</div></pre></td></tr></table></figure>
<p>It means requests from IP (127.0.0.1 to 127.0.0.255) will be considered safe and let pass.</p>

                    
                </div>

            </div>
        </article>

    </div>
</div>


    
        <div class="fluid-container">
    <div class="container">

        <article id="post-document/http_log" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                <header class="article-header">
                    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/document/http_log/">ngx_http_log_module</a>
    </h1>
  

                </header>
                
                <div class="article-entry" itemprop="articleBody">
                    
                    <p>Logging via syslog and pipe is supported in tengine. To use it, you should enable the syslog module first:</p>
<p>./configure –with-syslog</p>
<p>The syslog module can talk directly to syslogd or syslog-ng.</p>
<p>og sampling is also possible in tengine to reduce the count of log records.</p>
<h2 id="Directives"><a href="#Directives" class="headerlink" title="Directives"></a>Directives</h2><p>Syntax: <strong>access_log</strong> log_target [format [ratio=ratio] [buffer=size]] | off</p>
<p>Default: access_log logs/access.log combined ratio=1</p>
<p>Context: http, server, location</p>
<p>Basically, you can use it as same as nginx’s ‘access_log’, and you can write down ‘ratio’ and ‘buffer’ after ‘format’ in any order.<br>Moreover, there are several enhancements: </p>
<ol>
<li><a href="#log_target">log_target</a></li>
<li><a href="#ratio">ratio</a></li>
</ol>
<h2 id="log-target"><a href="#log-target" class="headerlink" title="log_target"></a>log_target</h2><p>It’s compatible with the log_file parameter, while three new log media types are supported:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">file:/path/to/file</div><div class="line">syslog:facility[:[loglevel][:[target_ip:[target_port] | target_udgram_addr][:ident]]]</div><div class="line">&quot;pipe:/path/to/exec [param1 param2 ...]&quot;</div></pre></td></tr></table></figure>
<ul>
<li>‘file’<br>Disk file, which is the same as the nginx’s.</li>
<li><p>‘syslog’</p>
<p>Support logging via syslog (UDP).</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">facility := auth | authpriv | cron | daemon | ftp | kern | lpr | mail | mark</div><div class="line">          | news | security | syslog | user | uucp | local0 | local1 | local2</div><div class="line">          | local3 | local4 | local5 | local6 | local7</div><div class="line">loglevel := crit | err | error | emerg | panic | alert | warn | warning</div><div class="line">          | info | notice | debug</div><div class="line"></div><div class="line">        The default loglevel is &apos;info&apos;.</div><div class="line"></div><div class="line">    target_ip[:target_port]:</div><div class="line"></div><div class="line">        The IP address and port of destination server. The default port is 514.</div><div class="line">    And UDP is the only supported protocol.</div><div class="line"></div><div class="line">    target_udgram_addr:</div><div class="line"></div><div class="line">        Specify the address of unix_dgram. The default address is &quot;/dev/log&quot;.</div><div class="line">    UNIX DGRAM is the only supported protocol.</div><div class="line"></div><div class="line">    ident:</div><div class="line"></div><div class="line">        Specify the mark for your application.</div></pre></td></tr></table></figure>
<p>Here are a few examples:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">syslog:user:info:127.0.0.1:514:ident</div></pre></td></tr></table></figure>
<p>Log to 127.0.0.1:514, with facility ‘user’, level ‘info’ and ident ‘ident’.</p>
<pre><code>The output is something like this:
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">May  4 15:44:15 local ident[26490]: XXXXXXXX</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">syslog:auth:err:10.232.4.28::ident</div></pre></td></tr></table></figure>
<p>Log to 10.232.4.28:514, with facility ‘auth’, level ‘err’ and ident ‘ident’.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">syslog:user:info:/dev/log:ident</div></pre></td></tr></table></figure>
<p>Log to local Unix dgram(/dev/log), with facility ‘user’, level ‘info’ and ident ‘ident’.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">syslog:user::/dev/log:ident</div></pre></td></tr></table></figure>
<p>Log to local Unix dgram(/dev/log), with facility ‘user’, default level ‘info’ and ident ‘ident’.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">syslog:user:info::ident</div></pre></td></tr></table></figure>
<p>Log to default local Unix dgram(/dev/log), with facility ‘user’, level ‘info’ and ident ‘ident’.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">syslog:cron:debug:/dev/log</div></pre></td></tr></table></figure>
<p>Log to local Unix dgram(/dev/log), with facility ‘cron’, level ‘debug’ and default ident ‘NGINX’.</p>
<pre><code>The output is something like this:
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">May  4 15:44:15 local NGINX[26490]: XXXXXXXX</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">syslog:user::127.0.0.1</div></pre></td></tr></table></figure>
<p>Log to 127.0.0.1:514, with facility ‘user’, default level ‘info’ and default ident ‘NGINX’.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">syslog:user:debug</div></pre></td></tr></table></figure>
<p>Log to default local Unix dgram(/dev/log), with facility ‘user’, level ‘debug’ and default ident ‘NGINX’.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">syslog:user</div></pre></td></tr></table></figure>
<p>Log to default local Unix dgram(/dev/log), with facility ‘user’, default level ‘info’ and default ident ‘NGINX’.</p>
<ul>
<li>‘pipe’</li>
</ul>
<p>Since there may be space characters, the pipe name should be wrapped by quotes.</p>
<pre><code>The privilege of the pipe is the same the worker process (default user and group are &apos;nobody&apos;).
</code></pre><h2 id="ratio"><a href="#ratio" class="headerlink" title="ratio"></a>ratio</h2><p>Specify a sampling ratio.</p>
<p>For example, ratio=0.0001, which means tengine will log only once in every 10000 records.</p>
<p>This parameter must be explicitly specified, e.g. ratio=1, if you want to use the ‘buffer’ parameter.</p>
<p>Syntax: <strong>error_log</strong> log_target [debug | info | notice | warn | error | crit]</p>
<p>Default: error_log logs/error.log</p>
<p>Context: core, http, server, location</p>
<p>Syslog and pipe are also supported, which is similar to ‘access_log’.</p>
<p>Syntax: <strong>syslog_retry_interval</strong> seconds</p>
<p>Default: syslog_retry_interval 1800</p>
<p>Context: core</p>
<p>The retry interval in case tengine fails to connect to the remote syslog server. </p>
<p>Syntax: <strong>log_escape </strong> on | off | ascii</p>
<p>Default: log_escape on</p>
<p>Context: core, http, server, location</p>
<ul>
<li>‘on’: escape the special characters (exclude the <a href="http://en.wikipedia.org/wiki/Percent-encoding#Types_of_URI_characters" target="_blank" rel="external">reserved or unreserved characters</a>) in your access log.</li>
<li>‘off’: don’t escape the special characters.</li>
<li>‘acsii’: only escape the invisible characters in the ACSII table.</li>
</ul>

                    
                </div>

            </div>
        </article>

    </div>
</div>


    
        <div class="fluid-container">
    <div class="container">

        <article id="post-document_cn/benchmark_cn" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                <header class="article-header">
                    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/document_cn/benchmark_cn/">Tengine &amp; Nginx性能测试</a>
    </h1>
  

                </header>
                
                <div class="article-entry" itemprop="articleBody">
                    
                    <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>我们在Tengine中实现了SO_REUSEPORT [1]的支持。为了查看其效果，我们进行了一个简单的测试。我们在同一个局域网中部署了一共四台同等配置的服务器，其中一台同时部署Tengine和Nginx，分别监听不同的端口，另外三台部署ab，三个ab同时压测，从总并发100逐步递增到1000，分别压测Tengine和Nginx，访问空gif图片。</p>
<p>三种压测场景：</p>
<ol>
<li><p>Tengine打开SO_REUSEPORT，reuse_port on。2.  Nginx默认配置。3.  Nginx优化配置，关闭mutex锁，accept_mutex off。</p>
<p>ab压测命令：</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ab -r -n 10000000 -c 100 http://ip:81/empty.gif</div></pre></td></tr></table></figure>
<h2 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h2><p>``<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Intel(R)Xeon(R)E5-2650v2@2.60GHz 32core</div><div class="line">Intel Corporation 82599EB 10-Gigabit SFI/SFP+ Network Connection</div><div class="line">Red Hat Enterprise Linux Server release 5.7 (Tikanga)</div><div class="line">linux-3.17.2.x86_64</div><div class="line">128GB Memroy</div></pre></td></tr></table></figure></p>
<h2 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Nginx/1.6.2</div><div class="line">Tengine/2.1.0 ([http://tengine.taobao.org](http://tengine.taobao.org))</div><div class="line">ApacheBench/2.3</div></pre></td></tr></table></figure>
<h2 id="系统配置"><a href="#系统配置" class="headerlink" title="系统配置"></a>系统配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">net.ipv4.tcp_mem = 3097431 4129911 6194862</div><div class="line">net.ipv4.tcp_rmem = 4096 87380 6291456</div><div class="line">net.ipv4.tcp_wmem = 4096 65536 4194304</div><div class="line">net.ipv4.tcp_max_tw_buckets = 262144</div><div class="line">net.ipv4.tcp_tw_recycle = 0</div><div class="line">net.ipv4.tcp_tw_reuse  = 1</div><div class="line">net.ipv4.tcp_syncookies  = 1</div><div class="line">net.ipv4.tcp_fin_timeout = 15</div><div class="line">net.ipv4.ip_local_port_range = 1024 65535</div><div class="line">net.ipv4.tcp_max_syn_backlog = 65535</div><div class="line">net.core.somaxconn  = 65535</div><div class="line">net.core.netdev_max_backlog  = 200000</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Limit                 Soft Limit          Hard Limit            Units</div><div class="line">Max open  files         65535               65535               files</div></pre></td></tr></table></figure>
<h2 id="服务器配置"><a href="#服务器配置" class="headerlink" title="服务器配置"></a>服务器配置</h2><p>Nginx/1.6.2 配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">worker_processes auto;</div><div class="line">worker_cpu_affinity</div><div class="line">00000000000000000000000000000001</div><div class="line">00000000000000000000000000000010</div><div class="line">00000000000000000000000000000100</div><div class="line">00000000000000000000000000001000</div><div class="line">00000000000000000000000000010000</div><div class="line">00000000000000000000000000100000</div><div class="line">00000000000000000000000001000000</div><div class="line">00000000000000000000000010000000</div><div class="line">00000000000000000000000100000000</div><div class="line">00000000000000000000001000000000</div><div class="line">00000000000000000000010000000000</div><div class="line">00000000000000000000100000000000</div><div class="line">00000000000000000001000000000000</div><div class="line">00000000000000000010000000000000</div><div class="line">00000000000000000100000000000000</div><div class="line">00000000000000001000000000000000</div><div class="line">00000000000000010000000000000000</div><div class="line">00000000000000100000000000000000</div><div class="line">00000000000001000000000000000000</div><div class="line">00000000000010000000000000000000</div><div class="line">00000000000100000000000000000000</div><div class="line">00000000001000000000000000000000</div><div class="line">00000000010000000000000000000000</div><div class="line">00000000100000000000000000000000</div><div class="line">00000001000000000000000000000000</div><div class="line">00000010000000000000000000000000</div><div class="line">00000100000000000000000000000000</div><div class="line">00001000000000000000000000000000</div><div class="line">00010000000000000000000000000000</div><div class="line">00100000000000000000000000000000</div><div class="line">01000000000000000000000000000000</div><div class="line">10000000000000000000000000000000</div><div class="line">;</div><div class="line">worker_rlimit_nofile 65535;</div><div class="line"></div><div class="line">events &#123;</div><div class="line">  worker_connections 65535;</div><div class="line">  accept_mutex off;</div><div class="line">&#125;</div><div class="line"></div><div class="line">http &#123;</div><div class="line">  include mime.types;</div><div class="line">  default_type application/octet-stream;</div><div class="line">  access_log logs/access.log;</div><div class="line">  keepalive_timeout 0;</div><div class="line">  server &#123;</div><div class="line">    listen 82 backlog=65535;</div><div class="line">    server_name localhost;</div><div class="line">    location = /empty.gif &#123;</div><div class="line">      empty_gif;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Tengine/2.1.0配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">worker_processes auto;</div><div class="line">worker_cpu_affinity auto;</div><div class="line">worker_rlimit_nofile 65535;</div><div class="line"></div><div class="line">events &#123;</div><div class="line">  worker_connections 65535;</div><div class="line">  reuse_port on;</div><div class="line">&#125;</div><div class="line"></div><div class="line">http &#123;</div><div class="line">  include mime.types;</div><div class="line">  default_type application/octet-stream;</div><div class="line">  access_log logs/access.log;</div><div class="line">  keepalive_timeout 0;</div><div class="line">  server &#123;</div><div class="line">    listen 81 backlog=65535;</div><div class="line">    server_name localhost;</div><div class="line">    location = /empty.gif &#123;</div><div class="line">      empty_gif;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Tengine和Nginx只有reuse_port和accept_mutex两处配置不同。</p>
<pre><code>Tengine的worker_cpu_affinity等同于Nginx的相应配置。
</code></pre><h2 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h2><p><a href="images/reuseport.png"><img src="images/reuseport.png" alt="status"></a></p>
<ol>
<li>Tengine相比Nginx默认配置，提升200%的处理能力。</li>
<li>Tengine相比Nginx优化配置，提升60%的处理能力。</li>
</ol>
<p>[1] SO_REUSEPORT套接字属性：<a href="https://lwn.net/Articles/542629/" target="_blank" rel="external">https://lwn.net/Articles/542629/</a></p>

                    
                </div>

            </div>
        </article>

    </div>
</div>


    
        <div class="fluid-container">
    <div class="container">

        <article id="post-index" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                <header class="article-header">
                    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/index/">Introduction</a>
    </h1>
  

                </header>
                
                <div class="article-entry" itemprop="articleBody">
                    
                    <p>Tengine is a web server originated by <a href="http://en.wikipedia.org/wiki/Taobao" target="_blank" rel="external">Taobao</a>, the largest e-commerce website in Asia. It is based on the <a href="http://nginx.org" target="_blank" rel="external">Nginx</a> HTTP server and has many advanced features. Tengine has proven to be very stable and efficient on some of the top 100 websites in the world, including <a href="http://www.taobao.com" target="_blank" rel="external">taobao.com</a> and <a href="http://www.tmall.com/" target="_blank" rel="external">tmall.com</a>. </p>
<pre><code>Tengine has been an open source project since December 2011. It is being actively developed by the Tengine team, whose core members are from [Taobao](http://en.wikipedia.org/wiki/Taobao), [Sogou](http://en.wikipedia.org/wiki/Sogou) and other Internet companies. Tengine is a community effort and everyone is encouraged to [get involved](source.html).&lt;/div&gt;
</code></pre><p><a href="download/tengine-2.1.2.tar.gz"><img src="images/download.png" alt=""></a></p>
<h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><ul>
<li>All features of Nginx-1.6.2 are inherited, i.e., it is compatible with Nginx.</li>
<li><a href="document/dso.html">Dynamic module loading support (DSO)</a>. You don’t have to recompile Tengine when adding new modules to it.</li>
<li>SO_REUSEPORT support, so the connection setup speed could be <a href="document/benchmark.html">three times faster than Nginx</a>.</li>
<li>support for both <a href="http://nginx.org/en/docs/http/ngx_http_v2_module.html" target="_blank" rel="external">HTTP v2 protocol</a> and <a href="http://nginx.org/en/docs/http/ngx_http_spdy_module.html" target="_blank" rel="external">SPDY v3 protocol</a>, be able to use them <a href="document/http_core.html">together</a>.</li>
<li>Sends <a href="document/http_core.html">unbuffered upload</a> directly to HTTP and FastCGI backend servers, which saves disk I/Os.</li>
<li>More load balancing methods, e.g., <a href="document/http_upstream_consistent_hash.html">consistent hashing</a>, <a href="document/http_upstream_session_sticky.html">session persistence</a>, <a href="document/http_upstream_check.html">upstream health check</a>, and <a href="document/http_upstream_dynamic.html">resolving upstream domain names on the fly</a>.</li>
<li><a href="http://blog.zhuzhaoyuan.com/2012/01/a-mechanism-to-help-write-web-application-firewalls-for-nginx/" target="_blank" rel="external">Input body filter</a> support. It’s quite handy to write Web Application Firewalls using this mechanism.</li>
<li><a href="http://wiki.nginx.org/HttpLuaModule" target="_blank" rel="external">Dynamic scripting language (Lua)</a> support, which is very efficient and makes it easy to extend core functionalities.</li>
<li><a href="document/http_log.html">Logging enhancements</a>. Syslog (local and remote), pipe logging and log sampling are supported.</li>
<li>Support <a href="document/http_reqstat.html">collecting the running status of Tengine</a> according to specific key (domain, url, etc).</li>
<li><a href="document/ngx_limit_upstream_tries.html">Limits retries for upstream servers</a> (proxy, memcached, fastcgi, scgi, uwsgi).</li>
<li>Includes a mechanism to support <a href="document/proc.html">standalone processes</a>.</li>
<li><a href="document/http_sysguard.html">Protects the server</a> in case system load or memory use goes too high.</li>
<li><a href="document/http_concat.html">Multiple CSS or JavaScript requests can be combined</a> into one request to reduce download time.</li>
<li><a href="document/http_trim_filter.html">Removes unnecessary white spaces and comments</a> to reduce the size of a page.</li>
<li>The number of worker processes and CPU affinities can be set automatically.</li>
<li><a href="document/http_limit_req.html">The limit_req module</a> is enhanced with whitelist support and more conditions are allowed in a single location.</li>
<li><a href="document/http_footer_filter.html">Enhanced diagnostic information</a> makes it easier to troubleshoot errors.</li>
<li><a href="document/commandline.html">More user-friendly command lines</a>, e.g., showing all compiled-in modules and supported directives.</li>
<li>Expiration times can be specified for certain MIME types.</li>
<li>Error pages can be reset to ‘default’.</li>
<li>…</li>
</ul>
<h2 id="News"><a href="#News" class="headerlink" title="News"></a>News</h2><ul>
<li>[12/31/2015] <a href="download/tengine-2.1.2.tar.gz">Tengine-2.1.2</a> stable version released (<a href="changelog.html#2_1_2">changes</a>).</li>
<li>[08/12/2015] <a href="download/tengine-2.1.1.tar.gz">Tengine-2.1.1</a> stable version released (<a href="changelog.html#2_1_1">changes</a>).</li>
<li>[12/19/2014] <a href="download/tengine-2.1.0.tar.gz">Tengine-2.1.0</a> development version released (<a href="changelog.html#2_1_0">changes</a>).</li>
<li>[05/30/2014] <a href="download/tengine-2.0.3.tar.gz">Tengine-2.0.3</a> development version released (<a href="changelog.html#2_0_3">changes</a>).</li>
<li>[03/28/2014] <a href="download/tengine-2.0.2.tar.gz">Tengine-2.0.2</a> development version released (<a href="changelog.html#2_0_2">changes</a>).</li>
<li>[03/06/2014] <a href="download/tengine-2.0.1.tar.gz">Tengine-2.0.1</a> development version released (<a href="changelog.html#2_0_1">changes</a>).</li>
<li>[01/08/2014] <a href="download/tengine-2.0.0.tar.gz">Tengine-2.0.0</a> development version released (<a href="changelog.html#2_0_0">changes</a>).</li>
<li>[11/22/2013] <a href="download/tengine-1.5.2.tar.gz">Tengine-1.5.2</a> stable version released (<a href="changelog.html#1_5_2">changes</a>).</li>
<li>[08/29/2013] <a href="download/tengine-1.5.1.tar.gz">Tengine-1.5.1</a> stable version released (<a href="changelog.html#1_5_1">changes</a>).</li>
<li>[08/04/2013] We presented <a href="download/tengine@alibaba.pdf">Nginx Hacking at Alibaba</a> at <a href="http://coscup.org/2013/en/program/#day2_am" target="_blank" rel="external">COSCUP 2013</a>.</li>
<li>[07/31/2013] <a href="download/tengine-1.5.0.tar.gz">Tengine-1.5.0</a> stable version released (<a href="changelog.html#1_5_0">changes</a>).</li>
<li>[05/14/2013] <a href="download/tengine-1.4.6.tar.gz">Tengine-1.4.6</a> development version released (<a href="changelog.html#1_4_6">changes</a>).</li>
<li>[05/01/2013] <a href="download/tengine-1.4.5.tar.gz">Tengine-1.4.5</a> development version released (<a href="changelog.html#1_4_5">changes</a>).</li>
<li>[03/21/2013] <a href="download/tengine-1.4.4.tar.gz">Tengine-1.4.4</a> development version released (<a href="changelog.html#1_4_4">changes</a>).</li>
<li>[01/21/2013] <a href="download/tengine-1.4.3.tar.gz">Tengine-1.4.3</a> development version released (<a href="changelog.html#1_4_3">changes</a>).</li>
<li>[11/22/2012] <a href="download/tengine-1.4.2.tar.gz">Tengine-1.4.2</a> development version released (<a href="changelog.html#1_4_2">changes</a>).</li>
<li>[10/10/2012] <a href="download/tengine-1.4.1.tar.gz">Tengine-1.4.1</a> development version released (<a href="changelog.html#1_4_1">changes</a>).</li>
<li>[09/05/2012] <a href="download/tengine-1.4.0.tar.gz">Tengine-1.4.0</a> development version released (<a href="changelog.html#1_4_0">changes</a>).</li>
<li>[07/10/2012] We started the <a href="nginx_docs/cn/">Nginx Chinese Documentation Translation Project</a>.</li>
<li>[06/28/2012] Our <a href="http://nginx.org/cn/" target="_blank" rel="external">Chinese translation of Nginx’s documentation</a> was accepted by the Nginx team.</li>
<li>[06/09/2012] We presented <a href="download/taobao_nginx_2012_06.pdf">Nginx Use Cases and Development at Taobao</a> at ECOC Conference.</li>
<li>[05/25/2012] <a href="download/tengine-1.3.0.tar.gz">Tengine-1.3.0</a> stable version released (<a href="changelog.html#1_3_0">changes</a>).</li>
<li>[05/09/2012] <a href="download/tengine-1.2.5.tar.gz">Tengine-1.2.5</a> stable version released (<a href="changelog.html#1_2_5">changes</a>).</li>
<li>[03/30/2012] <a href="download/tengine-1.2.4.tar.gz">Tengine-1.2.4</a> stable version released (<a href="changelog.html#1_2_4">changes</a>).</li>
<li>[03/08/2012] We are writing <a href="book/index.html">an open book on Nginx development</a>.</li>
<li>[02/27/2012] <a href="download/tengine-1.2.3.tar.gz">Tengine-1.2.3</a> stable version released (<a href="changelog.html#1_2_3">changes</a>).</li>
<li>[01/11/2012] <a href="download/tengine-1.2.2.tar.gz">Tengine-1.2.2</a> stable version released (<a href="changelog.html#1_2_2">changes</a>).</li>
<li>[12/07/2011] We gave a talk on <a href="http://velocity.oreilly.com.cn/2011/index.php?func=session&amp;name=%E6%89%93%E9%80%A0%E5%AE%89%E5%85%A8%E3%80%81%E6%98%93%E8%BF%90%E7%BB%B4%E7%9A%84%E9%AB%98%E6%80%A7%E8%83%BDWeb%E5%B9%B3%E5%8F%B0%EF%BC%9A%E6%B7%98%E5%AE%9D%E7%BD%91Nginx%E5%AE%9A%E5%88%B6%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98" target="_blank" rel="external">Hacking Nginx</a> at Velocity China 2011.</li>
<li>[12/06/2011] <a href="download/tengine-1.2.1.tar.gz">Tengine-1.2.1</a> stable version released (<a href="changelog.html#1_2_1">changes</a>).</li>
<li>[12/02/2011] <a href="opensource.html">Tengine goes open source.</a></li>
</ul>
<h2 id="Mailing-list"><a href="#Mailing-list" class="headerlink" title="Mailing list"></a>Mailing list</h2><ul>
<li>Chinese: <a href="http://code.taobao.org/mailman/listinfo/tengine-cn" target="_blank" rel="external">http://code.taobao.org/mailman/listinfo/tengine-cn</a></li>
<li>English: <a href="http://code.taobao.org/mailman/listinfo/tengine" target="_blank" rel="external">http://code.taobao.org/mailman/listinfo/tengine</a></li>
</ul>

                    
                </div>

            </div>
        </article>

    </div>
</div>


    
        <div class="fluid-container">
    <div class="container">

        <article id="post-taocode_ad_login_bg" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                <header class="article-header">
                    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/taocode_ad_login_bg/">[![](https</a>
    </h1>
  

                </header>
                
                <div class="article-entry" itemprop="articleBody">
                    
                    <p><a href="http://click.aliyun.com/m/7687/" target="_blank" rel="external"><img src="https://img.alicdn.com/tps/TB1B3KoOpXXXXc0XFXXXXXXXXXX-980-514.jpg" alt=""></a></p>

                    
                </div>

            </div>
        </article>

    </div>
</div>


    
        <div class="fluid-container">
    <div class="container">

        <article id="post-changelog_cn" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                <header class="article-header">
                    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/changelog_cn/">变更列表</a>
    </h1>
  

                </header>
                
                <div class="article-entry" itemprop="articleBody">
                    
                    <h4 id="Tengine-2-1-2-2015-12-31"><a href="#Tengine-2-1-2-2015-12-31" class="headerlink" title="Tengine-2.1.2 [2015-12-31]"></a>Tengine-2.1.2 [2015-12-31]</h4><ul>
<li>Feature: ngx_http_reqstat_module模块可以跟踪记录请求的内部重定向 [cfsego]</li>
<li>Feature: 支持HTTP/2，支持向后兼容SPDY v3 [PeterDaveHello, cfsego]</li>
<li>Feature: ngx_debug_pool模块协助分析内存状况 [chobits]</li>
<li>Feature: 支持$upstream_cookie变量</li>
<li>Bugfix: 修复ngx_http_dyups_module模块对相同后端服务器合并的问题 [FqqCS, taoyuanyuan]</li>
<li>Bugfix: 修复不能编译lua-upstream-nginx-module模块的问题 [cfsego]</li>
<li>Bugfix: 修复ngx_http_concat_module模块对javascript无效的问题 [IYism]</li>
</ul>
<h4 id="Tengine-2-1-1-2015-08-12"><a href="#Tengine-2-1-1-2015-08-12" class="headerlink" title="Tengine-2.1.1 [2015-08-12]"></a>Tengine-2.1.1 [2015-08-12]</h4><ul>
<li>Feature: 支持动态upstream更新 [yzprofile]</li>
<li>Feature: 增强ngx_http_reqstat_module模块 [cfsego]</li>
<li>Feature: 增加ssl_verify_client_exception指令 [InfoHunter]</li>
<li>Change: 降低解析配置的内存消耗 [ilexshen]</li>
<li>Change: trim模块增加$trim_bytes和$trim_original_bytes [taoyuanyuan]</li>
<li>Change: 升级debian二进制包的版本到2.1.0 [PeterDaveHello]</li>
<li>Change: 将ngx_http_spdy_module模块集成到travis-ci自动编译 [chobits]</li>
<li>Change: 更新SPDY/3.1 [chobits]</li>
<li>Change: SPDY时关闭proxy_request_buffering指令 [chobits]</li>
<li>Change: 增加编译选项支持设置linker [tanguofu]</li>
<li>Bugfix: 修复SPDY的Backport bug [nginx official, ym]</li>
<li>Bugfix: SPDY和SSL模块一起编译时报错 [ym]</li>
<li>Bugfix: 修复打开reuseport的bug [monadbobo]</li>
</ul>
<h4 id="Tengine-2-1-0-2014-12-19"><a href="#Tengine-2-1-0-2014-12-19" class="headerlink" title="Tengine-2.1.0 [2014-12-19]"></a>Tengine-2.1.0 [2014-12-19]</h4><ul>
<li>Feature: 支持SO_REUSEPORT选项，以提升CPU负载均衡性和性能 [monadbobo]</li>
<li>Feature: 支持动态解析upstream中出现的域名 [InfoHunter]</li>
<li>Feature: rewrite指令支持重定向到命名location [yzprofile]</li>
<li>Feature: image_filter指令支持crop_keepx和crop_keepy参数 [Lax]</li>
<li>Feature: consistent_hash模块和session_sticky模块支持SSL会话保持 [dinic]</li>
<li>Feature: 支持travis-ci.org自动编译 [Jamyn]</li>
<li>Feature: 健康检查模块支持FASTCGI检查 [yzprofile]</li>
<li>Feature: 增强sysguard模块的功能 [InfoHunter]</li>
<li>Feature: 新增变量$normalized_request得到规范化的请求 [yunkai]</li>
<li>Feature: dso的include指令支持通配符 [monadbobo]</li>
<li>Feature: 新增gzip_clear_etag指令 [taoyuanyuan]</li>
<li>Feature: 为log_escape指令添加unprintable参数 [skoo87]</li>
<li>Change: 合并nginx-1.6.2版本的修改 [cfsego, taoyuanyuan, chobits]</li>
<li>Change: round robin负载均衡算法随机选择某个源站作为循环起点 [taoyuanyuan]</li>
<li>Change: 对共享内存中的碎片进行优化 [chobits]</li>
<li>Bugfix: SPDY/3关闭连接时去掉drop标志 [chobits]</li>
<li>Bugfix: 修复SPDY/3出现连接泄漏的问题 [chobits]</li>
<li>Bugfix: 修复limit_req模块将长度超过255个字符的key截断的问题 [chobits]</li>
<li>Bugfix: 解析/etc/resolv.conf中的IPv6地址出错 [lifeibo]</li>
<li>Bugfix: 通过红黑树查找到错误的upstream [taoyuanyuan]</li>
</ul>
<h4 id="Tengine-2-0-3-2014-05-30"><a href="#Tengine-2-0-3-2014-05-30" class="headerlink" title="Tengine-2.0.3 [2014-05-30]"></a>Tengine-2.0.3 [2014-05-30]</h4><ul>
<li>Feature: 支持按指定关键字(域名，url等)收集Tengine运行状态 [cfsego]</li>
<li>Feature: 支持debian、ubuntu打包 [betetrpm, szepeviktor]</li>
<li>Change: 合并nginx-1.4.7的修改 [chobits]</li>
<li>Change: 使用红黑树优化upstream配置解析和查找 [SarahWang]</li>
<li>Change: 更新版权信息</li>
<li>Bugfix: 修复session-sticky模块相关问题 [dinic]</li>
<li>Bugfix: 修复DSO编译和安装模块的问题 [cfsego]</li>
<li>Bugfix: 修复spdy相关问题 [chobits]</li>
</ul>
<h4 id="Tengine-2-0-2-2014-03-28"><a href="#Tengine-2-0-2-2014-03-28" class="headerlink" title="Tengine-2.0.2 [2014-03-28]"></a>Tengine-2.0.2 [2014-03-28]</h4><ul>
<li>Bugfix: 在读事件处理完后继续发送SPDY数据 [chobits]</li>
<li>Bugfix: CVE-2014-0133以及CVE-2014-0088 [chobits]</li>
</ul>
<h4 id="Tengine-2-0-1-2014-03-06"><a href="#Tengine-2-0-1-2014-03-06" class="headerlink" title="Tengine-2.0.1 [2014-03-06]"></a>Tengine-2.0.1 [2014-03-06]</h4><ul>
<li>Feature: 请求体不缓存的机制支持chunked输入 [yaoweibin]</li>
<li>Feature: trim模块支持更多规则，支持根据变量启用 [taoyuanyuan]</li>
<li>Feature: 利用/etc/resolv.conf自动配置resolver [lifeibo, yaoweibin]</li>
<li>Feature: 增加$ascii_变量前缀，可以生成任意ASCII字符 [yzprofile]</li>
<li>Feature: 增加”image_filter_crop_offset”指令 [lax]</li>
<li>Change: 合并截至nginx-1.4.6版本的所有修改 [chobits, cfsego]</li>
<li>Bugfix: 修正使用长连接进行健康检查时报错的问题 [lilbedwin]</li>
<li>Bugfix: 修正使用WebSocket时nginx崩溃的问题 [Hao Chen]</li>
<li>Bugfix: 减少nginx处理大文件时的内存消耗 [cfsego]</li>
<li>Bugfix: 在未设置URI时，禁用跳转到named locations的重定向</li>
</ul>
<h4 id="Tengine-2-0-0-2014-01-08"><a href="#Tengine-2-0-0-2014-01-08" class="headerlink" title="Tengine-2.0.0 [2014-01-08]"></a>Tengine-2.0.0 [2014-01-08]</h4><ul>
<li>Feature: 增强DSO模块，编译动态模块不再依赖原始编译环境 [monadbobo]</li>
<li>Feature: 支持SPDY v3协议，自动检测同一端口的SPDY请求和HTTP请求 [lilbedwin、chobits]</li>
<li>Feature: 支持设置proxy、memcached、fastcgi、scgi、uwsgi在后端失败时的重试次数 [supertcy]</li>
<li>Feature: tfs模块在RcServer心跳时汇报访问统计 [zhcn381]</li>
<li>Feature: if指令支持比较数值大小：’&gt;’、’&lt;’、’&gt;=’、’&lt;=’ [flygoast]</li>
<li>Feature: 健康检查模块支持长连接检查 [lilbedwin]</li>
<li>Feature: trim模块支持SSI和ESI的注释 [taoyuanyuan]</li>
<li>Feature: expires_by_types指令支持使用通配符，例如’text/*’匹配子类型 [zhcn381]</li>
<li>Feature: 增加$base64<em>decode</em>变量前缀，支持计算指定变量的base64解压结果 [yzprofile]</li>
<li>Feature: 增加$md5<em>encode</em>变量前缀，支持计算指定变量的md5哈希 [yzprofile]</li>
<li>Feature: 增加$time_http变量，支持按http格式输出当前时间 [flygoast]</li>
<li>Feature: 增加$full_request变量，取得原始的请求url，包括协议类型和域名 [yzprofile]</li>
<li>Feature: 增加$escape<em>uri</em>变量前缀，支持对指定变量进行url转义 [yzprofile]</li>
<li>Feature: 增加$raw_uri变量，支持取得不含参数的原始uri [flygoast]</li>
<li>Feature: 支持按微秒记录子请求的请求时间 [jinglong]</li>
<li>Feature: 增加API，支持对url进行base64编码 [lilbedwin]</li>
<li>Change: 合并nginx-1.4.4版本的修改 [cfsego]</li>
<li>Change: 修改stub_status模块，不对子请求进行统计 [jinglong]</li>
<li>Bugfix: 修正footer模块，不处理含有Content-Encoding头的响应 [yaoweibin]</li>
<li>Bugfix: 修正client_body_postpone_size指令设置为0时出现的问题 [yaoweibin]</li>
<li>Bugfix: 修正Lua模块编译时出现警告 [diwayou]</li>
</ul>
<h4 id="Tengine-1-5-2-2013-11-22"><a href="#Tengine-1-5-2-2013-11-22" class="headerlink" title="Tengine-1.5.2 [2013-11-22]"></a>Tengine-1.5.2 [2013-11-22]</h4><ul>
<li>Security: 修复CVE-2013-4547安全漏洞</li>
<li>Bugfix: 修复limit_req模块中nodelay无效的问题 [cfsego]</li>
<li>Bugfix: 修复trim模块在替换javascript异常的问题 [taoyuanyuan]</li>
</ul>
<h4 id="Tengine-1-5-1-2013-08-29"><a href="#Tengine-1-5-1-2013-08-29" class="headerlink" title="Tengine-1.5.1 [2013-08-29]"></a>Tengine-1.5.1 [2013-08-29]</h4><ul>
<li>Feature: 增加retry_cached_connection指令，可以关闭对后端长连接的无条件重试 [yaoweibin]</li>
<li>Feature: sysguard模块的sysguard_load指令中加入ncpu参数 [yzprofile]</li>
<li>Bugfix：修复referer模块在https协议时正则匹配失效的问题 [lilbedwin]</li>
<li>Bugfix：修复trim模块可能产生0长度块的问题 [taoyuanyuan]</li>
<li>Bugfix：修复在使用–without-dso选项时出现的编译错误 [zhuzhaoyuan]</li>
<li>Bugfix：修复两个编译警告 [zzjin, diwayou]</li>
</ul>
<h4 id="Tengine-1-5-0-2013-07-31"><a href="#Tengine-1-5-0-2013-07-31" class="headerlink" title="Tengine-1.5.0 [2013-07-31]"></a>Tengine-1.5.0 [2013-07-31]</h4><ul>
<li>Feature: 增加DSO（动态模块加载）兼容性校验机制 [monadbobo]</li>
<li>Feature: 增加了请求体不缓存到磁盘的机制，HTTP代理和FastCGI模块收到部分请求体即可以转发给后端服务器 [yaoweibin]</li>
<li>Feature: 增加了trim模块，该模块可以自动删除HTML页面中无意义的空白符和注释，减小页面的大小 [taoyuanyuan]</li>
<li>Feature: 加入accept filter机制，支持在连接接收以后进行过滤处理 [yzprofile]</li>
<li>Feature: 现在server_tag指令可以改变默认错误页面的服务器标识 [zhuzhaoyuan]</li>
<li>Bugfix：修复access_log指令中buffer参数失效的问题 [cfsego]</li>
<li>Bugfix：修复session_sticky模块在某些情况下没有发出session cookie的问题 [dinic]</li>
</ul>
<h4 id="Tengine-1-4-6-2013-05-14"><a href="#Tengine-1-4-6-2013-05-14" class="headerlink" title="Tengine-1.4.6 [2013-05-14]"></a>Tengine-1.4.6 [2013-05-14]</h4><ul>
<li>Bugifx：合并nginx-1.2.9的更新，修正CVE-2013-2070带来的安全问题。<br>该安全问题在1.4.0以后版本开始出现 [yaoweibin]</li>
</ul>
<h4 id="Tengine-1-4-5-2013-05-01"><a href="#Tengine-1-4-5-2013-05-01" class="headerlink" title="Tengine-1.4.5 [2013-05-01]"></a>Tengine-1.4.5 [2013-05-01]</h4><ul>
<li>Feature：增加一致性hash模块，可以为后端服务器提供一致性hash的负载均衡方法 [dinic]</li>
<li>Feature：通过keepalive_timeout指令可以设置后端keepalive连接的超时时间 [jinglong]</li>
<li>Feature：加入所有模块静态编译或者所有模块动态编译的编译选项 [monadbobo]</li>
<li>Change：更新Lua模块至0.7.19 [jinglong]</li>
<li>Change：合并Nginx-1.2.8的更新 [yaoweibin]</li>
<li>Bugfix：修正syslog和upstream_check模块在GCC-4.4.5上的编译警告 [magicbear]</li>
</ul>
<h4 id="Tengine-1-4-4-2013-03-21"><a href="#Tengine-1-4-4-2013-03-21" class="headerlink" title="Tengine-1.4.4 [2013-03-21]"></a>Tengine-1.4.4 [2013-03-21]</h4><ul>
<li>Feature：增加session_sticky模块，可以为客户端和后端服务器提供会话保持功能 [dinic]</li>
<li>Feature：sysguard模块增加空闲内存监控功能 [lifeibo]</li>
<li>Feature：geoip模块增加对地区数据库的支持 [jasonlfunk]</li>
<li>Feature：log_empty_request指令增加对408响应的空请求支持 [yaoweibin]</li>
<li>Change：合并Nginx-1.2.5至Nginx-1.2.7的更新 [cfsego]</li>
<li>Change：默认关闭CPU亲缘性 [cfsego]</li>
<li>Bugfix：修正在Solaris 11上sysguard和upstream_check模块编译出错的问题 [lifeibo, yaoweibin]</li>
<li>Bugfix：修正TFS模块返回值可能错误的问题 [zhcn381]</li>
<li>Bugfix: 修正TFS模块上传大文件可能出错的问题 [zhcn381]</li>
</ul>
<h4 id="Tengine-1-4-3-2013-01-21"><a href="#Tengine-1-4-3-2013-01-21" class="headerlink" title="Tengine-1.4.3 [2013-01-21]"></a>Tengine-1.4.3 [2013-01-21]</h4><ul>
<li>Feature：增加TFS模块，可以通过RESTful接口与TFS分布式文件系统通信 [zhcn381, monadbobo]</li>
<li>Feature：增加$sent_cookie_XXX系列变量，可以获取响应中Set-Cookie头的cookie值 [skoo87]</li>
<li>Feature：syslog指令的发送地址支持域名 [cfsego]</li>
<li>Change：upstream块中的server指令增加id属性 [yaoweibin]</li>
<li>Bugfix：DSO模块修正reload时可能失败的问题 [monadbobo]</li>
<li>Bugfix：修复upstream_check模块当超时时间长于检查时间可能导致段错误的问题 [yaoweibin]</li>
<li>Bugfix：修复user_agent模块在请求缺少User-Agent头会段错误的问题 [dinic]</li>
<li>Bugfix：修复sysguard模块在Mac OS下面不能工作的问题 [lizi]</li>
</ul>
<h4 id="Tengine-1-4-2-2012-11-22"><a href="#Tengine-1-4-2-2012-11-22" class="headerlink" title="Tengine-1.4.2 [2012-11-22]"></a>Tengine-1.4.2 [2012-11-22]</h4><ul>
<li>Feature：增加–dso-tool-path配置选项，可以选择dso_tool脚本的安装目录 [monadbobo]</li>
<li>Feature：增加$unix_time变量，表示当前的时间戳秒数 [yaoweibin]</li>
<li>Feature：Makefile中增加test命令以便运行测试用例 [yaoweibin]</li>
<li>Feature：sysguard模块可在location里面配置 [lifeibo]</li>
<li>Change：合并Nginx-1.2.4和Nginx-1.2.5的更新 [zhuzhaoyuan]</li>
<li>Change：增加对input_filter函数返回值的检查，防止第三方模块调用出错 [cfsego]</li>
<li>Bugfix：修复limit_req指令不能使用4个参数的问题，感谢LazyZhu的报告 [monadbobo]</li>
<li>Bugfix：修复在cygwin下面编译sysinfo文件出错的问题，感谢Cao Peiran的报告 [lifeibo]</li>
<li>Bugfix：修复user-agent模块安装时需要拷贝browsers配置文件的问题，感谢Jianbin Xiao的报告 [monadbobo]</li>
<li>Bugfix：修复DSO模块RPM打包安装目录出错的问题，感谢Jianbin Xiao和Ren Xiaolei的报告 [monadbobo]</li>
</ul>
<h4 id="Tengine-1-4-1-2012-10-10"><a href="#Tengine-1-4-1-2012-10-10" class="headerlink" title="Tengine-1.4.1 [2012-10-10]"></a>Tengine-1.4.1 [2012-10-10]</h4><ul>
<li>Feature： 添加jemalloc库的支持 [fanjizhao]</li>
<li>Feature： 加入$dollar变量, 它的值就是美元符号 [zhuzhaoyuan]</li>
<li>Feature： 为worker_cpu_affinity指令加入off选项 [cfsego]</li>
<li>Change： 当工作进程异常退出以后，新进程不会绑定CPU亲缘性 [cfsego]</li>
<li>Bugfix: 修正在Mac OS操作系统下，Lua模块与LuaJIT动态编译时出现的错误 [monadbobo]</li>
<li>Bugfix: 修正动态编译第三方filter模块时出现的模块执行顺序错误 [monadbobo]</li>
</ul>
<h4 id="Tengine-1-4-0-2012-09-05"><a href="#Tengine-1-4-0-2012-09-05" class="headerlink" title="Tengine-1.4.0 [2012-09-05]"></a>Tengine-1.4.0 [2012-09-05]</h4><ul>
<li>Feature： 增加动态模块加载支持（DSO），要添加一个模块不再需要重新编译tengine了 [monadbobo]</li>
<li>Feature： 更新Lua模块到最新的稳定版本 [chaoslawful, agentzh, jinglong]</li>
<li>Feature： 为健康检查模块增加json和csv格式的输出 [yaoweibin]</li>
<li>Feature： 增加log_empty_request指令，可以用来关掉空请求日志——那些连接了但没发数据的连接 [zhuzhaoyuan]</li>
<li>Feature： 给concat模块增加concat_delimiter指令，设置文件间的间隔内容 [dinic]</li>
<li>Feature： 增加concat_ignore_file_error指令并允许concat的语法更宽松 [dinic]</li>
<li>Feature： 给error_page指令增加default选项，以恢复所有的错误页面为默认值 [jinglong]</li>
<li>Feature： 给proc模块增加priority指令，可设置proc进程的优先级 [yzprofile]</li>
<li>Feature： 给proc模块增加delay_start指令，可设置延迟加载时间 [yzprofile]</li>
<li>Change： 集成最新nginx稳定版本1.2.3的内容 [zhuzhaoyuan]</li>
<li>Bugfix： 修正一个geo模块设了range但是没有默认值时产生的段错误问题 [yzprofile]</li>
<li>Bugfix： 修正一个proc模块的空指针问题 [yzprofile]</li>
<li>Bugfix： 修正一个健康检查模块的socket泄漏问题 [yaoweibin]</li>
<li>Bugfix： 修正limit_req模块的若干问题 [monadbobo]</li>
<li>Bugfix： 修正若干日志输出类型错误的问题 [yaoweibin]</li>
<li>Bugfix： 修正perl模块和proc一起打开的一个编译错误 [yzprofile]</li>
</ul>
<h4 id="Tengine-1-3-0-2012-05-25"><a href="#Tengine-1-3-0-2012-05-25" class="headerlink" title="Tengine-1.3.0 [2012-05-25]"></a>Tengine-1.3.0 [2012-05-25]</h4><ul>
<li>Feature：加入Lua模块，可以在配置中使用Lua语言 [chaoslawful, agentzh]</li>
<li>Feature：加入procs模块，可以更方便的开启独立进程 [yzprofile]</li>
<li>Change：user_agent模块中参数nongreedy改名为greedy [dinic]</li>
<li>Bugfix：修复syslog指令中因为指针未初始化引起的段错误 [cfsego]</li>
<li>Bugfix：修复syslog指令打开–with-ipv6选项引起的编译错误 [cfsego]</li>
</ul>
<h4 id="Tengine-1-2-5-2012-05-09"><a href="#Tengine-1-2-5-2012-05-09" class="headerlink" title="Tengine-1.2.5 [2012-05-09]"></a>Tengine-1.2.5 [2012-05-09]</h4><ul>
<li>Feature：增加upstream_check模块，对后端服务器做主动健康检查，以自动的下线失效的服务器 [yaoweibin]</li>
<li>Feature：允许syslog输出日志时指定程序的标识（program identifier） [cfsego]</li>
<li>Change：合并nginx-1.0.14至nginx-1.0.15之间的修改 [zhuzhaoyuan]</li>
<li>Change：将accept_mutex_delay的默认值从500毫秒更改为100毫秒以提高性能 [zhuzhaoyuan]</li>
<li>Bugfix：修复syslog的一个在后端服务器连接不上导致端错误的bug [cfsego]</li>
<li>Bugfix：修复access_log可能和buffer参数冲突的bug [cfsego]</li>
</ul>
<h4 id="Tengine-1-2-4-2012-03-30"><a href="#Tengine-1-2-4-2012-03-30" class="headerlink" title="Tengine-1.2.4 [2012-03-30]"></a>Tengine-1.2.4 [2012-03-30]</h4><ul>
<li>Feature：增加user_agent模块 [dinic]</li>
<li>Feature：增加log_escape指令 [agentzh, skoo87]</li>
<li>Change：合并nginx-1.0.12至nginx-1.0.14之间的修改 [zhuzhaoyuan]</li>
<li>Bugfix：修复limit_req模块的一个bug [liseen.wan]</li>
<li>Bugfix：修复subrequest的一个bug [lifeibo]</li>
</ul>
<h4 id="Tengine-1-2-3-2012-02-27"><a href="#Tengine-1-2-3-2012-02-27" class="headerlink" title="Tengine-1.2.3 [2012-02-27]"></a>Tengine-1.2.3 [2012-02-27]</h4><ul>
<li>Feature：增加request_time_cache指令，用来控制是否启用精确的响应时间 [yzprofile]</li>
<li>Feature：增加slice模块，获得一个文件的一个片段，可以添加头和尾 [zhuzhaoyuan]</li>
<li>Change：合并nginx-1.0.11至nginx-1.0.12之间的修改 [zhuzhaoyuan]</li>
<li>Change：去掉无用的user-agent判断 [zhuzhaoyuan]</li>
<li>Bugfix：修复upstream中的一个process_header的bug [lifeibo]</li>
<li>Bugfix：修复expires_by_types的一个bug [lifeibo]</li>
</ul>
<h4 id="Tengine-1-2-2-2012-01-11"><a href="#Tengine-1-2-2-2012-01-11" class="headerlink" title="Tengine-1.2.2 [2012-01-11]"></a>Tengine-1.2.2 [2012-01-11]</h4><ul>
<li>Feature：增加input body filter机制 [cfsego]</li>
<li>Feature：对mail部分支持ssl的dialog [cfsego]</li>
<li>Change：合并进nginx-1.0.10至nginx-1.0.11之间的修改 [zhuzhaoyuan]</li>
<li>Change：默认关掉lingering_close [zhuzhaoyuan]</li>
<li>Bugfix：修正日志管道时的bug [cfsego]</li>
<li>Bugfix：修正limit_req的forbid_action无效的bug [monadbobo]</li>
<li>Bugfix: 修正backtrace模块backtrace_max_stack_size的问题 [monadbobo]</li>
<li>Bugfix：修正内容为空footer模块输出不正确的问题 [dinic]</li>
<li>Bugfix：修正syslog时hostname最后一个字母丢失的问题 [cfsego]</li>
</ul>
<h4 id="Tengine-1-2-1-2011-12-06"><a href="#Tengine-1-2-1-2011-12-06" class="headerlink" title="Tengine-1.2.1 [2011-12-06]"></a>Tengine-1.2.1 [2011-12-06]</h4><ul>
<li>Bugfix：修正默认错误日志和访问日志不存在时启动报错的bug [yzprofile]</li>
</ul>
<h4 id="Tengine-1-2-0-2011-11-29"><a href="#Tengine-1-2-0-2011-11-29" class="headerlink" title="Tengine-1.2.0 [2011-11-29]"></a>Tengine-1.2.0 [2011-11-29]</h4><ul>
<li>Feature：错误日志和访问日志支持输出到syslog [cfsego]</li>
<li>Feature：错误日志和访问日志支持输出到管道的方式 [cfsego]</li>
<li>Feature：增加realloc相关的API，包括内存池 [gongyuan]</li>
<li>Feature：HTTP日志支持更多的有关时间的变量 [skoo87]</li>
<li>Feature：增加backtrace模块，在coredump时输出调用栈 [monadbobo]</li>
<li>Feature：limit_req功能增强，增加白名单，可以有多个条件 [monadbobo]</li>
<li>Feature：sysguard模块，load和内存占用偏高时进行保护 [lifeibo]</li>
<li>Feature：增加API（ngx_http_header_in/ngx_http_header_out），用来取输入和输出的HTTP头信息 [lifeibo]</li>
<li>Feature：增加两个变量$request_time_msec和$request_time_usec，分别是相应时间的毫秒表示和微秒表示 [jinglong]</li>
<li>Feature：增加footer模块，可以在HTML末尾添加内容（支持变量） [yunxing]</li>
<li>Feature：增加变量$conn_requests，记录当前request是连接上的第几个 [lieyuan]</li>
<li>Feature：增加变量$host_comment，插入注释功能，以说明哪台机器产生的请求 [yunxing]</li>
<li>Feature：访问日志增加ratio参数，抽样功能，可以减少日志的记录量 [cfsego]</li>
<li>Feature：增加server_admin、server_info指令，出错信息提示，更友好的错误页面 [lieyuan]</li>
<li>Feature：增加命令行参数-d，把配置文件的内容全部打印出来 [piaoliang]</li>
<li>Feature：增加指令expires_by_types，可以根据types来设置超时 [lifeibo]</li>
<li>Feature：增加命令行参数-l，可以列出所有的directives [dinic]</li>
<li>Feature：增加ngx_atoll的api，可以将字符串转换成64位整数，支持32位与64位系统 [lifeibo]</li>
<li>Feature：status line（302，405）现在采用RFC 2616的标准 [zhuzhaoyuan]</li>
<li>Feature：ngx_escape_uri/ngx_unescape_uri现在支持PHP/Java的编解码格式 [zhuzhaoyuan]</li>
<li>Feature：配置文件include多个文件时按照字母顺序进行包含 [zhuzhaoyuan]</li>
<li>Feature：error_page指令增强，支持default，可以把把上一级设置的error_page重新设定 [zhuzhaoyuan]</li>
<li>Feature：增加对每请求的响应时间的统计（cacti，tsar） [jinglong]</li>
<li>Feature：增加指令server_tag，更强大的控制HTTP服务器的Server头是否显示以及内容是什么 [jinglong]</li>
<li>Feature：自动调整worker进程的数目和绑定CPU亲缘性 [cfsego]</li>
<li>Feature：增加指令ssl_pass_phrase_dialog，SSL对key进行加密功能 [cfsego]</li>
<li>Feature：增加-s选项的start参数 [zhuzhaoyuan]</li>
<li>Feature：增加-m选项，可以把已编译的模块列出来 [zhuzhaoyuan]</li>
<li>Change：更改msie_padding的默认值为关掉 [zhuzhaoyuan]</li>
<li>Bugfix：修复open_file_cache在已经检测到缓存文件发生变化后，仍然返回过时的文件状态信息的问题 [cfsego]</li>
<li>Bugfix：修复upsteam在subrequest in memory且keepalive时会导致timeout的bug [lifeibo]</li>
<li>Bugfix：修复$sent_http_connection和$sent_http_keep_alive记录不正确的问题 [zhongsheng]</li>
<li>Bugfix：修正error_page不能发现重复的code的问题，不能正常继承上一级设置的问题 [zhuzhaoyuan]</li>
<li>Bugfix：修正Nginx在处理FastCGI时有重复HTTP头会core dump的bug [monadbobo]</li>
<li>Bugfix：修正Nginx对CPU亲缘性设置不正确的bug [cfsego]</li>
</ul>

                    
                </div>

            </div>
        </article>

    </div>
</div>


    
        <div class="fluid-container">
    <div class="container">

        <article id="post-taocode_ad_nav_text" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                <header class="article-header">
                    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/01/taocode_ad_nav_text/">[买服务器](htt</a>
    </h1>
  

                </header>
                
                <div class="article-entry" itemprop="articleBody">
                    
                    <p><a href="http://click.aliyun.com/m/4282/" target="_blank" rel="external">买服务器</a></p>

                    
                </div>

            </div>
        </article>

    </div>
</div>


    


<nav id="page-nav">
    <a class="extend prev" rel="prev" href="/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/blog/page/3/">3</a><a class="page-number" href="/blog/page/4/">4</a><a class="extend next" rel="next" href="/blog/page/3/">__('next') &raquo;</a>
</nav>



</section>
  </div>
  <div class="fluid-container global-footer">
  <div class="container">
    <div class="row">
      <div class="col-lg-6">
        <div class="footer-logo"></div>
      </div>
      <div class="col-lg-6 clearfix">
        <select name="" id="" class="lang-switch pull-right">
          <option value="cn" selected>China</option>
          <option value="en">World</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12">
        <span class="footer-text copyright">
          &copy; 2011-2016 Alibaba Inc. All rights reserved.
        </span>
        <span class="footer-text design-by">Designed by 阿里云UED AX</span>
      </div>
    </div>
  </div>
</div>



  
<script src="/js/jquery.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/particles.min.js"></script>
<script src="/js/jquery.scrollTo-1.4.2-min.js"></script>
<script src="/js/jquery.localscroll-1.2.7-min.js"></script>
<script src="/js/jquery.parallax-1.1.3.js"></script>
<script src="/js/app.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


</body>
</html>